---
#
#
#
# https://www.reddit.com/r/homeassistant/comments/ni0hjg/feel_like_temperature_sensor/
#
platform: template
sensors:
  weather_feel_like_temperature:
    friendly_name: "Det føles som udenfor"
    unique_id: '15c57d6c-2662-4150-be62-8f538fbfc1bb'
    unit_of_measurement: '°C'
    value_template: "
    {% set temp = state_attr('weather.hasselhaven', 'temperature') |float %} {## in celcius ##}
    {% set humi = state_attr('weather.hasselhaven', 'humidity') |float %} {## in percent ##}
    {% set wise = state_attr('weather.hasselhaven', 'wind_speed') |float %} {## at 10 meter above ground in km/h ##} 
    {% if temp <= 10 and wise >= 5 %}
      {% set new_wind_chill = (13.12 
      + 0.6215 * temp 
      + -11.37 * wise**0.16 
      + 0.3965 * temp * wise**0.16)|round(1) %}
      {{ new_wind_chill }}
    {% elif temp >= 27 and humi >= 40 and wise <= 15 %} 
      {% set heat_index = (-8.78469475556 
      + 1.61139411 * temp 
      + 2.33854883889 * humi 
      + -0.14611605 * humi * temp 
      + -0.012308094 * temp * temp 
      + -0.0164248277778 * humi * humi 
      + 0.002211732 * humi * temp * temp  
      + 0.00072546 * humi * humi * temp 
      + -0.000003582 * humi * humi * temp * temp)|round(1) %}
      {{ heat_index }}
    {% else %}
      {% set australian_apparent_temperature = (temp 
      + 0.33 * (humi/100) * 6.105 * e**(17.27 * temp / ( 237.7 + temp )) 
      + -0.7 * wise/3.6
      + -4.00)|round(1) %} {## wind speed in m/s ##}
      {{ australian_apparent_temperature }}
    {% endif %}
    "